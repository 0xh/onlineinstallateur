<div class="row filter_row">
	<div class="col-md-12">
     	<div class="match-filter bg-light-grey clean" id="filterCollection">
     		<ul class = "category-container nav-tabs">
     			{assign var=elements value=0}
     			{loop type="search_feature" name="search_feature_loop" category=$category_id}
      				{if $SEARCHABLE}
	          			{$featureId = $ID}
	          			{assign var=elements value=$elements+1}
	          			{append var='featureCollection' value=$ID index=$elements}
	          			<li class = "col-md-3 main-category test" class="select-search">
	          				<a class="category-head feature-{$ID}" a data-toggle="tab" href="#{$ID}" data-feature="{$ID}">
	          					<span>{$TITLE}</span>
	          				</a>
	          			</li>
	          			{if $elements%4==0 && $elements>0 }
	          				</ul>
	          				<div class="tab-content col-md-12 options_collection">
		          				{foreach from=$featureCollection key=k item=fID}
		          					{if $featureCollection.{$k} != null}
			          					<div id="{$fID}" class="tab tab-pane fade options-container clean row">
			          						{loop type="search_feature_av" name="search_feature_av_loop" feature=$fID category={', '|implode:$categories} return_empty=false force_return=true}
												<div class="checkbox filter-option col-md-4 col-sm-12">	
													<div class="controller_wrapper clean checkbox-box">
														<div class="checkbox">
															<input type="checkbox" data-name="level_price"  class="input-search" value="{$ID}" id="feature-{$fID}-{$ID}" name="features[{$fID}][]" data-tracked="true">
															<label for="feature-{$fID}-{$ID}">
																<span>{$TITLE}</span> 
																{strip}{$DESCRIPTION nofilter}{/strip}
															</label>
														</div>
													</div>
												</div>
											 {/loop}
			          					</div>
			          				{/if}
		          					{$featureCollection.{$k} = null}
		          				{/foreach}
	          				</div>
	          				<ul class = "category-container nav-tabs">
	          			{/if}
      				{/if}
     			{/loop}
     		</ul>
     		<div class="tab-content col-md-12 options_collection">
  				{foreach from=$featureCollection key=k item=fID}
			        {if $featureCollection.{$k} != null}
	  					<div id="{$fID}" class="tab tab-pane fade options-container clean row">
	  						{loop type="search_feature_av" name="search_feature_av_loop" feature=$fID category={', '|implode:$categories} return_empty=false force_return=true}
								<div class="checkbox filter-option col-md-4 col-sm-12">	
									<div class="controller_wrapper clean checkbox-box">
										<div class="checkbox">
											<input type="checkbox" data-name="level_price"  class="input-search" value="{$ID}" id="feature-{$fID}-{$ID}" name="features[{$fID}][]" data-tracked="true">
											<label for="feature-{$fID}-{$ID}">
												<span>{$TITLE}</span> 
												{strip}{$DESCRIPTION nofilter}{/strip}
											</label>
										</div>
									</div>
								</div>
							 {/loop}
	  					</div>
	  				{/if}
			        {$featureCollection.{$k} = null}
  				{/foreach}
			</div>
		</div>
	</div>
</div>
<div class="row mobile_filter_row">
	<div class="col-md-12">
		<div id="mobileFilter"></div>
	</div>
</div>

<script type="text/javascript">
	window.onload = function() {
	    if (window.jQuery) {  
	        // jQuery is loaded  
	        $( ".category-head" ).each(function( index ) {
				
				$('<div class="mobileFilterItem">'+
					'<button class="btn btn-primary col-lg-12 col-md-12 col-sm-12 col-xs-12" type="button" data-toggle="collapse" data-target="#mobile'+
						$( this ).attr('data-feature')+
						'" aria-expanded="false" aria-controls="mobile'+$( this ).attr('data-feature')+'">'+
						$( this ).text() +
				  	'</button>'+
				  	'<div class="collapse" id="mobile'+$( this ).attr('data-feature')+'">'+
				  		'<div class="card card-block">'+
				  			'<div class="tab-content col-md-12 options_collection">'+
				  				$('#'+$( this ).attr('data-feature')).html()+
				  			'</div>'+
				  		'</div>'+
				  	'</div>'+
				'</div>').appendTo('#mobileFilter');
			});

	        $("#mobileFilter .mobileFilterItem .options_collection .filter-option .checkbox-box .checkbox :checkbox").each(function( index ) {
				$( this).attr("id", "mobile-"+$( this).attr("id")); 
			});

			$("#mobileFilter .mobileFilterItem .options_collection .filter-option .checkbox-box .checkbox label").each(function( index ) {
				$( this ).attr("for", "mobile-"+$( this).attr("for")); 
			});
			
	        /*var mobile_filter_row = $("#mobileFilter");
			var desktop_filter_row = $("#filterCollection");
			mobile_filter_row.detach();
			desktop_filter_row.detach();

			function checkWidth() {
			    var windowWidth = $(window).width();
			    if (windowWidth < 992) {
			        //$(".filter_row").hide();
					desktop_filter_row.detach();			        
			        $(".mobile_filter_row").append(mobile_filter_row);
			    } else {
			        //$(".filter_row").show();
			        mobile_filter_row.detach();
			        $(".filter_row").append(desktop_filter_row);
			    }
			}*/

			function checkWidth() {
			    var windowWidth = $(window).width();
			    if (windowWidth < 992) {
			        $(".filter_row").hide();
			        $(".mobile_filter_row").show();
			    } else {
			        $(".filter_row").show();
			        $(".mobile_filter_row").hide();
			    }
			}

			//buildMobile();

			checkWidth();

			$(window).resize(checkWidth);

	    } else {
	        
	    }
	}
</script>