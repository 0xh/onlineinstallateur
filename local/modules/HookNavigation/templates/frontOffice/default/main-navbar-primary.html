
<nav class="navbar navbar-default nav-main grey minnu flyout" role="navigation" itemscope itemtype="http://schema.org/SiteNavigationElement">
    <div class="container-fluid">
        <div class="navbar-header">

            <a class="navbar-brand visible-xs-block visible-sm-block" href="{navigate to="index"}">{*intl l="categories" d="hooknavigation.fo.default"*}</a>
        </div>
        <div class="collapse navbar-collapse" id="navbar-primary">
            <ul class="nav navbar-nav navbar-categories">
                <!--li><a href="{navigate to="index"}" class="home">{intl l="Home" d="hooknavigation.fo.default"}</a></li-->
                {loop type="category" name="category.navigation" parent="0" need_count_child="yes"}
                {if $CHILD_COUNT > 0}
                    <li class="dropdown mega-minnu ">
                        <a href="{$URL}">{$TITLE}</a>
                        <ul class="dropdown-menu minnu-menu" role="menu">

                            {assign var="parent_id" value=$ID}
                            {assign var="MAX_SUB_CAT" value={($CHILD_COUNT / 3)|round:0}}
                            {assign var="SUB_CAT_OFFSET" value=0 }


                            {if $MAX_SUB_CAT < 4}
                            	{if $CHILD_COUNT <6}
                            	<div class="col-sm-3">
		                            	{loop type="category" name="sub-cat" parent="{$ID}"}
		                            	<li>
		                                    <a href="{$URL}"><strong>{$TITLE}</strong></a>
		                            	</li> 
		                                    {loop type="category" name="sub-sub-cat" parent="{$ID}" limit="5"}
												<li>
		                                   			<a href="{$URL}">{$TITLE}</a>
		                            			</li>    
		                            		{/loop}
		                            		</br> 
		                            	{/loop}
		                         </div>
		                         
		                         		<div class="col-sm-3">
		                            		{loop name="category.image" type="image" source="category" source_id={$ID}  limit="1"}
		                                		<a href="{$TITLE}"><img itemprop="image" src="{$IMAGE_URL nofilter}" alt="{$TITLE}" class="menu-block-border" ></a>
		                            		{/loop}
		                            	</div>
		
		                            	<div class="col-sm-3">
		                            		{loop name="category.image" type="image" source="category" source_id={$ID} offset="1" limit="1"}
		                                		<a href="{$TITLE}"><img itemprop="image" src="{$IMAGE_URL nofilter}" alt="{$TITLE}" class="menu-block-border"></a>
		                            		{/loop}
		                            	</div>
		                            	
		                            	<div class="col-sm-3">
		                            		{loop name="category.image" type="image" source="category" source_id={$ID} offset="2"  limit="1"}
		                                		<a href="{$TITLE}"><img itemprop="image" src="{$IMAGE_URL nofilter}" alt="{$TITLE}" class="menu-block-border" ></a>
		                            		{/loop}
		                            	</div>
                            	{else}
		                            	{assign var="MAX_SUB_CAT" value={($CHILD_COUNT / 2)|round:0}}
		                            	{for $fori=0 to 1}
		                            	<div class="col-sm-3">
		                            	{loop type="category" name="sub-cat" parent="{$ID}" offset=$MAX_SUB_CAT*$fori limit="$MAX_SUB_CAT"}
		                            	<li>
		                                    <a href="{$URL}"><strong>{$TITLE}</strong></a>
		                            	</li> 
		                                    {loop type="category" name="sub-sub-cat" parent="{$ID}" limit="5"}
												<li>
		                                   			<a href="{$URL}">{$TITLE}</a>
		                            			</li>    
		                            		{/loop}
		                            		</br> 
		                            	{/loop}
		                            </div>
		                            {/for}
		                            	<div class="col-sm-3">
		                            		{loop name="category.image" type="image" source="category" source_id={$ID}  limit="1"}
		                                		<a href="{$TITLE}"><img itemprop="image" src="{$IMAGE_URL nofilter}" alt="{$TITLE}" class="menu-block-border" ></a>
		                            		{/loop}
		                            		</br>
		                            		{loop name="category.image" type="image" source="category" source_id={$ID} offset="1" limit="1"}
		                                		<a href="{$TITLE}"><img itemprop="image" src="{$IMAGE_URL nofilter}" alt="{$TITLE}" class="menu-block-border"></a>
		                            		{/loop}
		                            	</div>
		
		                            	<div class="col-sm-3">
		                            		{loop name="category.image" type="image" source="category" source_id={$ID} offset="2" limit="1"}
		                                		<a href="{$TITLE}"><img itemprop="image" src="{$IMAGE_URL nofilter}" alt="{$TITLE}" class="menu-block-border" ></a>
		                            		{/loop}
		                            		</br>
		                            		{loop name="category.image" type="image" source="category" source_id={$ID} offset="3" limit="1"}
		                                		<a href="{$TITLE}"><img itemprop="image" src="{$IMAGE_URL nofilter}" alt="{$TITLE}" class="menu-block-border"></a>
		                            		{/loop}
		                            	</div>
                            	{/if}
                            {else}
                            	{for $fori=0 to 2}
                            	<div class="col-sm-3">
                            	{loop type="category" name="sub-cat" parent="{$ID}" offset=$MAX_SUB_CAT*$fori limit="$MAX_SUB_CAT"}
                            	<li>
                                    <a href="{$URL}"><strong>{$TITLE}</strong></a>
                            	</li> 
                                    {loop type="category" name="sub-sub-cat" parent="{$ID}" limit="5"}
										<li>
                                   			<a href="{$URL}">{$TITLE}</a>
                            			</li>    
                            		{/loop}
                            		</br> 
                            	{/loop}
                            	</div>
                            {/for}
                            <div class="col-sm-3">
                            	{loop name="category.image" type="image" source="category" source_id={$ID}  limit="1"}
                                	<a href="{$TITLE}"><img itemprop="image" src="{$IMAGE_URL nofilter}" alt="{$TITLE}" class="menu-block-border" ></a>
                            	{/loop}
                            </br>
                            	{loop name="category.image" type="image" source="category" source_id={$ID} offset="1" limit="1"}
                                	<a href="{$TITLE}"><img itemprop="image" src="{$IMAGE_URL nofilter}" alt="{$TITLE}" class="menu-block-border"></a>
                            	{/loop}
                            </div>
                            {/if}    
                        </ul>
                    </li>
                {else}
                    <li><a href="{$URL}">{$TITLE}</a></li>
                {/if}
                {/loop}
                    <li>
                    <a href="/sofunktionierts">{intl l="SO FUNKTIONIERT'S" }</a></li>
            </ul>
        </div>
    </div>
</nav>

{* classic navbar without dropdown
<nav class="navbar navbar-default nav-main" role="navigation" itemscope itemtype="http://schema.org/SiteNavigationElement">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-primary">
                <span class="sr-only">{intl l="Toggle navigation" d="hooknavigation.fo.default"}</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand visible-xs-block visible-sm-block" href="{navigate to="index"}">{intl l="Kategorien" d="hooknavigation.fo.default"}</a>
        </div>
        <div class="collapse navbar-collapse" id="navbar-primary">
            <ul class="nav navbar-nav navbar-categories">
                <li><a href="{navigate to="index"}" class="home">{intl l="Home" d="hooknavigation.fo.default"}</a></li>
                {loop type="category" name="category.navigation" parent="0"}
                <li><a href="{$URL}">{$TITLE}</a></li>
                {/loop}
            </ul>
        </div>
    </div>
</nav>
*}